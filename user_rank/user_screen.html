<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- displays site properly based on user's device -->

    <link
      href="https://fonts.googleapis.com/css2?family=Barlow+Semi+Condensed:wght@600;700&display=swap"
      rel="stylesheet"
    />
    <script src="./module/enterprise.min.js"></script>

    <!-- <script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.min.noStyle.js"></script> -->
    <!-- Include the core CSS, this is needed by the grid -->
    <link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/ag-grid-community/styles/ag-grid.css"/>
    <!-- Include the theme CSS, only need to import the theme you are going to use -->
    <link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/ag-grid-community/styles/ag-theme-alpine.css"/>
      <link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/ag-grid-community/styles/ag-theme-balham.css"/>
    <!-- Feel free to remove these styles or customise in your own stylesheet ğŸ‘ -->
    
    <link href="https://unpkg.com/tabulator-tables@5.5.2/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>
    <link rel="stylesheet" href="./assets/main.css" />

    <style>
      .attribution {
        font-size: 11px;
        text-align: center;
      }
      .attribution a {
        color: hsl(228, 45%, 44%);
      }
    </style>
    <script src="https://static.afreecatv.com/asset/app/extension-helper/afreecatv-extension-sdk.js"></script>
  </head>
  <body>
    <script defer src="./js/user_main.js">
    </script>

    <title>ì—°ìŠµ ìš©</title>

    <div id="tab">

      <div id="tab_button_balloon">
        <div>
          ë³„í’ì„ 
        </div>
      </div>
      <div id="tab_button_adballoon">
        <div>
          ì• ë“œë²Œë£¬
        </div>
      </div>
      <div id="tab_button_chatting">
        <div>
          ì±„íŒ…
        </div>
      </div>
      <div id="tab_button_viewTime">
        <div>
          ì‹œì²­
        </div>
      </div>
    </div>
    <div id="table" class="ag-theme-balham-dark" style="height: 500px"></div>
    <script type="text/javascript">
        // Grid Options are properties passed to the grid
        const gridOptions = {

          // each entry here represents one column
          columnDefs: [
            {
              lockPosition: 'left',
              valueGetter: 'node.rowIndex+1',
              cellClass: 'locked-col',
              maxWidth: 40,
              suppressNavigable: true,
            },
            { field: "ë‹‰ë„¤ì„", maxWidth: 100},
            { field: "ì„ ë¬¼ê°œìˆ˜", maxWidth: 90 },
            { field: "ì„ ë¬¼íšŸìˆ˜", maxWidth: 90  },
            {
              field: "balloonSendPercent",
              headerName:"ì„ ë¬¼ê°œìˆ˜ë¹„ìœ¨",
              cellRenderer: "agSparklineCellRenderer",
              cellRendererParams: {
                sparklineOptions: {
                  type: "bar",
                  fill: "#5470c6",
                  stroke: "#91cc75",
                  highlightStyle: {
                    fill: "#fac858"
                  },
                  valueAxisDomain: [0, 1],
                  paddingOuter: 0,
                  padding: {
                    top: 0,
                    bottom: 0
                  },
                  axis: {
                    strokeWidth: 0
                  }
                }
              },
              maxWidth: 115 
            },
          ],

          // default col def properties get applied to all columns

          rowSelection: 'multiple', // allow rows to be selected
          animateRows: true, // have rows animate to new positions when sorted
          // editable: false,
          // cellDataType: true,
          // example event handler
          onCellClicked: params => {
            console.log('cell was clicked', params)
          }
        };

        // get div to host the grid
        const eGridDiv = document.getElementById("table");
        // new grid instance, passing in the hosting DIV and Grid Options
        new agGrid.Grid(eGridDiv, gridOptions);

        data = [{
            "ë‹‰ë„¤ì„" : 'sonia',
            "ì„ ë¬¼ê°œìˆ˜" : 20,
            "ì„ ë¬¼íšŸìˆ˜" : 2,
            "balloonSendPercent" : [0.2]
          },
          {
            "ë‹‰ë„¤ì„" : 'love',
            "ì„ ë¬¼ê°œìˆ˜" : 100,
            "ì„ ë¬¼íšŸìˆ˜" : 2,
            "balloonSendPercent" : [0.5]

          },
          {
            "ë‹‰ë„¤ì„" : 'test',
            "ì„ ë¬¼ê°œìˆ˜" : 30,
            "ì„ ë¬¼íšŸìˆ˜" : 2,
            "balloonSendPercent" : [0.3]
          },
        ]
          // load fetched data into grid
          gridOptions.api.setRowData(data);
    </script>
    <script defer>
      setTimeout( () => {
        window.game = new User();

        const SDK = window.AFREECA.ext;
        window.extensionSDK = SDK();
        function init() {
            window.game = new User();
        }
        extensionSDK.handleInitialization((userInfo, broadInfo, playerInfo) => {
          init();
        });
  
        extensionSDK.broadcast.listen( (action, message, formId) => {
          console.log(action,message, formId)
          game.receiver(message);
        });

      }, 1000)
    </script>
  </body>
</html>
